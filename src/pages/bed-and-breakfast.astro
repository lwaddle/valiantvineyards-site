---
import BaseLayout from "../layouts/BaseLayout.astro";
import Button from "../components/Button.astro";
import RoomImageWithGallery from "../components/RoomImageWithGallery.svelte";
import { Image, getImage } from "astro:assets";
import heroImage from "../assets/images/wine-glass-next-to-bed-with-lamp.jpg";

// Import all room images
// Honeymoon Suite
import honeymoon1 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-1.jpg";
import honeymoon3 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-3.jpg";
import honeymoon5 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-5.jpg";
import honeymoon6 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-6.jpg";
import honeymoon7 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-7.jpg";
import honeymoon8 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-8.jpg";
import honeymoon9 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-9.jpg";
import honeymoon11 from "../assets/images/rooms/honeymoon-suite/honeymoon-suite-11.jpg";

// Frontier Room
import frontier1 from "../assets/images/rooms/frontier-room/frontier-room-1.jpg";
import frontier2 from "../assets/images/rooms/frontier-room/frontier-room-2.jpg";
import frontier3 from "../assets/images/rooms/frontier-room/frontier-room-3.jpg";

// Queen Anne Room
import queenAnne1 from "../assets/images/rooms/queen-anne-room/queen-anne-room-1.jpg";
import queenAnne2 from "../assets/images/rooms/queen-anne-room/queen-anne-room-2.jpg";
import queenAnne3 from "../assets/images/rooms/queen-anne-room/queen-anne-room-3.jpg";

// USD Room
import usd0 from "../assets/images/rooms/usd-room/usd-room-0.jpg";
import usd1 from "../assets/images/rooms/usd-room/usd-room-1.jpg";
import usd2 from "../assets/images/rooms/usd-room/usd-room-2.jpg";
import usd3 from "../assets/images/rooms/usd-room/usd-room-3.jpg";
import usd4 from "../assets/images/rooms/usd-room/usd-room-4.jpg";
import usd5 from "../assets/images/rooms/usd-room/usd-room-5.jpg";
import usd6 from "../assets/images/rooms/usd-room/usd-room-6.jpg";
import usd8 from "../assets/images/rooms/usd-room/usd-room-8.jpg";
import usd9 from "../assets/images/rooms/usd-room/usd-room-9.jpg";
import usd10 from "../assets/images/rooms/usd-room/usd-room-10.jpg";

// John Crane Room
import johnCrane1 from "../assets/images/rooms/john-crane-room/john-crane-room-1.jpg";
import johnCrane2 from "../assets/images/rooms/john-crane-room/john-crane-room-2.jpg";
import johnCrane3 from "../assets/images/rooms/john-crane-room/john-crane-room-3.jpg";
import johnCrane4 from "../assets/images/rooms/john-crane-room/john-crane-room-4.jpg";

// Native American Room
import nativeAmerican1 from "../assets/images/rooms/native-american-room/native-american-room-1.jpg";
import nativeAmerican2 from "../assets/images/rooms/native-american-room/native-american-room-2.jpg";
import nativeAmerican3 from "../assets/images/rooms/native-american-room/native-american-room-3.jpg";
import nativeAmerican4 from "../assets/images/rooms/native-american-room/native-american-room-4.jpg";

// Helper to optimize images for gallery
async function optimizeImages(images: { src: ImageMetadata; alt: string }[]) {
  return Promise.all(
    images.map(async (img) => {
      const optimized = await getImage({ src: img.src, width: 1200, format: 'webp' });
      return { src: optimized.src, alt: img.alt };
    })
  );
}

// Room data with optimized images
const rooms = [
  {
    name: "Honeymoon Suite",
    price: "$150+",
    specialPrice: "$195",
    description: "Luxurious King-size bed with an in-room Jacuzzi tub for the ultimate romantic getaway.",
    features: ["King Bed", "In-Room Jacuzzi", "Private Bath"],
    heroImage: honeymoon1,
    images: await optimizeImages([
      { src: honeymoon1, alt: "Honeymoon Suite" },
      { src: honeymoon3, alt: "Honeymoon Suite" },
      { src: honeymoon5, alt: "Honeymoon Suite" },
      { src: honeymoon6, alt: "Honeymoon Suite" },
      { src: honeymoon7, alt: "Honeymoon Suite" },
      { src: honeymoon8, alt: "Honeymoon Suite" },
      { src: honeymoon9, alt: "Honeymoon Suite" },
      { src: honeymoon11, alt: "Honeymoon Suite" },
    ]),
  },
  {
    name: "Frontier Room",
    price: "$140+",
    specialPrice: "$175",
    description: "Two comfortable Queen beds with a private bath featuring a relaxing Jacuzzi tub and shower.",
    features: ["2 Queen Beds", "Jacuzzi Tub", "Private Bath"],
    heroImage: frontier1,
    images: await optimizeImages([
      { src: frontier1, alt: "Frontier Room" },
      { src: frontier2, alt: "Frontier Room" },
      { src: frontier3, alt: "Frontier Room" },
    ]),
  },
  {
    name: "Queen Anne Room",
    price: "$135+",
    specialPrice: "$175",
    description: "Two comfortable Queen beds and a private bath with a relaxing Jacuzzi tub and shower.",
    features: ["2 Queen Beds", "Jacuzzi Tub", "Private Bath"],
    heroImage: queenAnne1,
    images: await optimizeImages([
      { src: queenAnne1, alt: "Queen Anne Room" },
      { src: queenAnne2, alt: "Queen Anne Room" },
      { src: queenAnne3, alt: "Queen Anne Room" },
    ]),
  },
  {
    name: "USD Room",
    price: "$135+",
    specialPrice: "$175",
    description: "Two inviting Queen beds decorated with school spirit for University of South Dakota fans.",
    features: ["2 Queen Beds", "USD Theme", "Private Bath"],
    heroImage: usd0,
    images: await optimizeImages([
      { src: usd0, alt: "USD Room" },
      { src: usd1, alt: "USD Room" },
      { src: usd2, alt: "USD Room" },
      { src: usd3, alt: "USD Room" },
      { src: usd4, alt: "USD Room" },
      { src: usd5, alt: "USD Room" },
      { src: usd6, alt: "USD Room" },
      { src: usd8, alt: "USD Room" },
      { src: usd9, alt: "USD Room" },
      { src: usd10, alt: "USD Room" },
    ]),
  },
  {
    name: "John Crane Room",
    price: "$130+",
    specialPrice: "$175",
    description: "Luxurious King-size bed with a European reading chair and lamp, perfect for a peaceful retreat.",
    features: ["King Bed", "Reading Nook", "Private Bath"],
    heroImage: johnCrane1,
    images: await optimizeImages([
      { src: johnCrane1, alt: "John Crane Room" },
      { src: johnCrane2, alt: "John Crane Room" },
      { src: johnCrane3, alt: "John Crane Room" },
      { src: johnCrane4, alt: "John Crane Room" },
    ]),
  },
  {
    name: "Native American Room",
    price: "$125+",
    specialPrice: "$160",
    description: "Two Queen-size beds in our handicap-accessible suite, featuring beautiful Native American decor.",
    features: ["2 Queen Beds", "Accessible", "Private Bath"],
    heroImage: nativeAmerican1,
    images: await optimizeImages([
      { src: nativeAmerican1, alt: "Native American Room" },
      { src: nativeAmerican2, alt: "Native American Room" },
      { src: nativeAmerican3, alt: "Native American Room" },
      { src: nativeAmerican4, alt: "Native American Room" },
    ]),
  },
];

const amenities = [
  { id: "tasting", title: "Tasting Included", description: "Complimentary wine & spirits tasting for all guests" },
  { id: "breakfast", title: "Homemade Breakfast", description: "Served daily from 8:00 - 10:00 AM" },
  { id: "location", title: "Prime Location", description: "Minutes from USD and downtown Vermillion" },
  { id: "bath", title: "Private Baths", description: "Each room features its own private bathroom" },
];
---

<BaseLayout title="Bed & Breakfast" description="Stay overnight at Valiant Vineyards Bed & Breakfast. Six uniquely themed rooms with complimentary wine tasting and homemade breakfast.">
  <!-- Hero Section -->
  <section class="relative">
    <div class="relative min-h-[60vh] xl:min-h-[75vh] flex items-center justify-center py-24">
      <Image
        src={heroImage}
        alt="Cozy bed with wine glass at Valiant Vineyards Bed and Breakfast"
        class="absolute inset-0 h-full w-full object-cover object-center"
        widths={[640, 1024, 1536, 2048]}
        sizes="100vw"
        quality={90}
      />
      <div class="absolute inset-0 bg-black/50"></div>

      <div class="container relative mx-auto px-4 lg:px-8 text-center">
        <h1 class="font-serif text-4xl font-semibold tracking-tight text-white sm:text-5xl lg:text-6xl">
          Stay With Us
        </h1>
        <p class="mt-4 text-xl text-white font-semibold max-w-2xl mx-auto [text-shadow:0_1px_4px_rgb(0_0_0/60%)]">
          Where a good night's rest meets great wine & spirits
        </p>
      </div>
    </div>
  </section>

  <!-- Introduction -->
  <section class="py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="mx-auto max-w-3xl text-center">
        <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-6">
          South Dakota's Premier Vineyard Retreat
        </h2>
        <p class="text-lg leading-relaxed text-muted-foreground mb-4">
          Experience the charm of our Bed & Breakfast nestled in the heart of Valiant Vineyards. Each of our six uniquely themed rooms offers a peaceful escape with modern comforts and authentic South Dakota hospitality.
        </p>
        <p class="text-lg leading-relaxed text-muted-foreground">
          Your stay includes complimentary wine tasting and a delicious homemade breakfast served each morning.
        </p>
      </div>
    </div>
  </section>

  <!-- Amenities -->
  <section class="bg-neutral-50 py-16 lg:py-20">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-4 max-w-5xl mx-auto">
        {amenities.map((amenity) => (
          <div class="text-center">
            <div class="mb-3 flex justify-center">
              {amenity.id === "tasting" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              )}
              {amenity.id === "breakfast" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
              )}
              {amenity.id === "location" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
              )}
              {amenity.id === "bath" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                </svg>
              )}
            </div>
            <h3 class="font-serif text-lg font-semibold mb-1">{amenity.title}</h3>
            <p class="text-sm text-muted-foreground">{amenity.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Rooms Section -->
  <section class="py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-4">
          Our Rooms
        </h2>
        <p class="text-muted-foreground max-w-2xl mx-auto">
          Six uniquely themed rooms, each with its own character and charm
        </p>
      </div>

      <div class="space-y-24 lg:space-y-32">
        {rooms.map((room, index) => (
          <div class:list={[
            "grid gap-8 lg:gap-12 items-center",
            "lg:grid-cols-2"
          ]}>
            <!-- Clickable Hero Image with Gallery -->
            <div class:list={[
              "overflow-hidden rounded-lg shadow-lg",
              index % 2 === 1 ? "lg:order-last" : ""
            ]}>
              <RoomImageWithGallery
                client:visible
                heroSrc={room.images[0].src}
                heroAlt={room.name}
                images={room.images}
                roomName={room.name}
              />
            </div>

            <!-- Room Info -->
            <div class={index % 2 === 1 ? "lg:pr-8" : "lg:pl-8"}>
              <div class="flex items-baseline gap-3 mb-3">
                <h3 class="font-serif text-2xl font-semibold sm:text-3xl">
                  {room.name}
                </h3>
                <span class="text-xl font-semibold text-gold">{room.price}</span>
              </div>

              <p class="text-lg text-muted-foreground mb-4">
                {room.description}
              </p>

              <!-- Features -->
              <div class="flex flex-wrap gap-2 mb-6">
                {room.features.map((feature) => (
                  <span class="inline-flex items-center rounded-full bg-secondary px-3 py-1 text-sm font-medium text-secondary-foreground">
                    {feature}
                  </span>
                ))}
              </div>

              <!-- Reserve Button -->
              <Button
                href="tel:6056244500"
                variant="gold"
                size="lg"
                class="inline-flex items-center gap-2"
              >
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                </svg>
                Call to Reserve
              </Button>
              <p class="mt-2 text-sm text-muted-foreground">
                (605) 624-4500
              </p>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Special Rates Notice -->
  <section class="bg-burgundy text-white py-12 lg:py-16">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="mx-auto max-w-3xl text-center">
        <h2 class="font-serif text-2xl font-semibold sm:text-3xl mb-4">
          Special Event Rates
        </h2>
        <p class="text-white/90 mb-4">
          During Dakota Days, USD Graduation, and other special weekends, our rates are adjusted:
        </p>
        <div class="flex flex-wrap justify-center gap-4 text-sm">
          <span class="bg-white/10 px-4 py-2 rounded-full">Honeymoon Suite: $195</span>
          <span class="bg-white/10 px-4 py-2 rounded-full">Premium Rooms: $175</span>
          <span class="bg-white/10 px-4 py-2 rounded-full">Native American: $160</span>
        </div>
        <p class="mt-4 text-white/70 text-sm">
          3-night minimum stay required for special event weekends
        </p>
      </div>
    </div>
  </section>

  <!-- Policies Section -->
  <section class="py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="mx-auto max-w-4xl">
        <h2 class="font-serif text-3xl font-semibold tracking-tight text-center sm:text-4xl mb-12">
          Guest Information
        </h2>

        <div class="grid gap-8 md:grid-cols-2">
          <!-- Check-in/out -->
          <div class="rounded-lg border border-border bg-background p-6">
            <h3 class="font-serif text-xl font-semibold mb-4 text-gold">Check-In & Check-Out</h3>
            <ul class="space-y-2 text-muted-foreground">
              <li class="flex justify-between">
                <span>Check-in</span>
                <span class="font-medium text-foreground">2:00 PM</span>
              </li>
              <li class="flex justify-between">
                <span>Check-out</span>
                <span class="font-medium text-foreground">11:00 AM</span>
              </li>
              <li class="flex justify-between">
                <span>Breakfast</span>
                <span class="font-medium text-foreground">8:00 - 10:00 AM</span>
              </li>
            </ul>
          </div>

          <!-- Policies -->
          <div class="rounded-lg border border-border bg-background p-6">
            <h3 class="font-serif text-xl font-semibold mb-4 text-gold">Policies</h3>
            <ul class="space-y-2 text-muted-foreground text-sm">
              <li>7-day cancellation policy</li>
              <li>30-day notice for groups & special events</li>
              <li>No pets allowed</li>
              <li>Children under 10 stay free</li>
              <li>Ages 11+ charged $15/night</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="bg-neutral-50 py-16 lg:py-20">
    <div class="container mx-auto px-4 lg:px-8 text-center">
      <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-4">
        Ready to Book Your Stay?
      </h2>
      <p class="text-muted-foreground mb-8 max-w-xl mx-auto">
        Call us to reserve your room and start planning your getaway.
      </p>
      <Button
        href="tel:6056244500"
        variant="gold"
        size="lg"
        class="inline-flex items-center gap-2"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
        </svg>
        (605) 624-4500
      </Button>
    </div>
  </section>
</BaseLayout>
